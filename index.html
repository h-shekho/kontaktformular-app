<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Kontaktformular</title>
</head>
<body>
    <div id="lightning"></div>
    <script src="https://beyerdynamic--devverve.sandbox.my.site.com/faq/lightning/lightning.out.js"></script>
    <script>
        // Lightning Out App initialisieren
        $Lightning.use(
            "c:ReklamationsformularOut",
            function() {
                // Initiale Komponente laden
                loadComponent();
            },
            "https://beyerdynamic--devverve.sandbox.my.site.com/faq/"
        );

        function loadComponent() {
            const urlParams = new URLSearchParams(window.location.search);
            const componentName = urlParams.get('component') || 'kontaktFormularStartseite';
            const language = urlParams.get('language') || 'de';

            // Container leeren
            document.getElementById('lightning').innerHTML = '';

            // Komponente erstellen
            $Lightning.createComponent(
                "c:" + componentName,
                {
                    selectedLanguage: language
                },
                "lightning",
                function(cmp, status, errorMessage) {
                    if (status === "ERROR") {
                        console.error('Fehler beim Laden der Komponente:', errorMessage);
                    }
                }
            );
        }

        // Event Listener f√ºr Navigation
        document.addEventListener('lwc:navigate', function(event) {
            const component = event.detail.component;
            const language = event.detail.language;

            // URL aktualisieren ohne Reload
            const url = new URL(window.location.href);
            url.searchParams.set('component', component);
            url.searchParams.set('language', language);
            window.history.pushState({}, '', url);

            // Neue Komponente laden
            loadComponent();
        });

        // Browser Back/Forward Handler
        window.onpopstate = loadComponent;
    </script>
</body>
</html>
