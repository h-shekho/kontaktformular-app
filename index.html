
<div id="lightning"></div>
<script src="https://beyerdynamic--devverve.sandbox.my.site.com/faq/lightning/lightning.out.js"></script>
<script>
    // Globale Variable fÃ¼r die aktuelle App-Instanz
    let lightningApp;

    function initializeLightningOut() {
        return new Promise((resolve) => {
            $Lightning.use("c:ReklamationsformularOut", function() {
                lightningApp = this;
                resolve();
            },
            "https://beyerdynamic--devverve.sandbox.my.site.com/faq/"
            );
        });
    }

    async function createComponent(componentName, params = {}) {
        if (!lightningApp) {
            await initializeLightningOut();
        }

        return new Promise((resolve) => {
            $Lightning.createComponent(
                "c:" + componentName,
                params,
                "lightning",
                function(cmp) {
                    console.log("Component created:", componentName);
                    resolve(cmp);
                }
            );
        });
    }

    async function handleNavigation() {
        const params = new URLSearchParams(window.location.search);
        const componentName = params.get('component') || 'kontaktFormularStartseite';
        const language = params.get('language') || 'de';

        // Container leeren
        const lightning = document.getElementById('lightning');
        lightning.innerHTML = '';

        // Neue Komponente erstellen
        await createComponent(componentName, { selectedLanguage: language });
    }

    // Initiale Navigation
    handleNavigation();

    // Navigation Event Listener
    window.addEventListener('navigate', async function(event) {
        const { component, language } = event.detail;
        const url = new URL(window.location.href);
        url.searchParams.set('component', component);
        url.searchParams.set('language', language);
        window.history.pushState({}, '', url);
        await handleNavigation();
    });

    // Browser Back/Forward Navigation
    window.addEventListener('popstate', handleNavigation);
</script>
